{% extends 'base.html.twig' %}

{% block title %}Liste des sous-categories{% endblock %}


{% block body %}

<div class="container">
    <div class="row mt-5 p-3 bg-darkblue">
        <div class="col-12 text-light text-center">
            <h1>{{category.title}}</h1>
        </div>
    </div>

    {# Fil d'Ariane #}
    <div class="row mb-5">
        <div class="ariane col-12 text-center bg-darkblue m-0 d-flex flex-column justify-content-center flex-lg-row pb-3">
            <div class="px-3 py-2"><a href="{{ path('home') }}">Accueil</a></div>
            <span class="px-3 py-2"><i class="fas fa-angle-right"></i></span>
            <div class="px-3 py-2 text-white">
                <a href="#">{{ category.title }} </a>
            </div>
        </div>
    </div>

    {# Bloc principal -> Sous-catégories #}
    <div class="row">
        <h2 class="fw-bolder">Sous-Catégories</h2>
        {% if is_granted('ROLE_MODERATOR') %}
        <a href="{{ path('new_subcategory', {slug: category.slug }) }}">
            <button class="btn btn-darkblue mt-3">Ajouter une sous-catégorie</button>
        </a>
        {% endif %}

        <div class="col-12 col-md-8 offset-md-2 col-lg-12 offset-lg-0 ">
            <div class="row pb-4 mb-4 justify-content-lg-start">

                {% for subCategory in category.subCategories %}

                    <div class="col-6 col-md-6 col-lg-2 my-2">
                        <a href="{{ path('forumlist', {slug: subCategory.slug}) }}">
                            <div class="category w-100 d-flex flex-column justify-content-center align-items-center bg-lightblue p-1 rounded-3">

                                <img class="mb-1" src="{{ asset('images/subcategories/' ~ subCategory.image ) }}" alt="">
                                <div class="category-title mt-1 pt-2">
                                    <h2 class="text-center fs-5 fs-lg-3">{{ subCategory.title|capitalize }}</h2>
                                </div>

                                {% if is_granted('ROLE_MODERATOR') %}

                                    <div class="mt-3 text-center">
                                        <a class="text-white" href="{{ path('edit_sub_category', {id: subCategory.id})
                                        }}">
                                            <button class="btn btn-primary mb-3 mx-1">Modifier</button>
                                        </a>
                                        <form
                                                class="mx-1"
                                                method="post"
                                                action="{{ path('delete_sub_category', {'id': subCategory.id}) }}"
                                                onsubmit="return confirm('Etes-vous sûr de vouloir supprimer cette sous-catégorie ?');"
                                        >
                                            <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ subCategory.id) }}">
                                            <button class="btn btn-danger">Supprimer</button>
                                        </form>
                                    </div>

                                {% endif %}
                            </div>
                        </a>
                    </div>

                {% else %}
                    <div class="col-12 my-2 p-5">
                        <p class="bg-darkblue rounded-3 p-5 fs-1">Aucune sous-catégorie à afficher !</p>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>



{% endblock %}